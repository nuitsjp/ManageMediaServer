# auto-setup.sh æ®µéšçš„æ¤œè¨¼TODO

## æ¤œè¨¼ã‚¹ã‚¿ã‚¤ãƒ«ãƒ»æ‰‹é † ğŸ“

### åŸºæœ¬çš„ãªæ¤œè¨¼ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
1. **æ®µéšçš„ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ**: auto-setup.shã§æ¤œè¨¼å¯¾è±¡å¤–ã®å‡¦ç†ã‚’æ®µéšçš„ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
2. **å®Ÿéš›ã®å®Ÿè¡Œ**: `--dry-run`ã§ã®ç¢ºèªå¾Œã€å®Ÿéš›ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¦å‹•ä½œç¢ºèª
3. **çµæœæ¤œè¨¼**: ãƒ­ã‚°ç¢ºèªå¾Œã€å®Ÿéš›ã«ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«çŠ¶æ³ã‚’ç¢ºèª
4. **æ®µéšçš„è§£é™¤**: æ¤œè¨¼å®Œäº†å¾Œã€æ¬¡ã®å‡¦ç†ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’è§£é™¤ã—ã¦é€²è¡Œ

### æ¤œè¨¼ç’°å¢ƒ
- **ç’°å¢ƒ**: WSLé–‹ç™ºç’°å¢ƒ (dev)
- **æ¨©é™**: sudoæ¨©é™ã§å®Ÿè¡Œ
- **ãƒ™ãƒ¼ã‚¹ã‚³ãƒãƒ³ãƒ‰**: `cd /mnt/d/ManageMediaServer && sudo ./scripts/setup/auto-setup.sh --force`

---

## Phase 1: åŸºæœ¬æ©Ÿèƒ½ç¢ºèª ğŸ“‹ âœ… **å®Œäº†**

### å®Œäº†æ¸ˆã¿
- [x] **ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿ãƒ»ç’°å¢ƒåˆ¤å®šç¢ºèª** âœ…
  - WSLç’°å¢ƒãŒæ­£ã—ã `dev` ã¨ã—ã¦åˆ¤å®š
  - å…¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£å¸¸ã«èª­ã¿è¾¼ã¿
  - ç’°å¢ƒå¤‰æ•°(PROJECT_ROOT, DATA_ROOT, BACKUP_ROOT)ãŒé©åˆ‡ã«è¨­å®š

---

## Phase 2: ã‚·ã‚¹ãƒ†ãƒ åŸºç›¤ç¢ºèª ğŸ”§ âœ… **å®Œäº†**

### å®Œäº†æ¸ˆã¿
- [x] **Dockerã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‰å‡¦ç†ï¼ˆStep 1-4ï¼‰** âœ…
  - äº‹å‰ãƒã‚§ãƒƒã‚¯ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæº–å‚™ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å±•é–‹ã€ã‚·ã‚¹ãƒ†ãƒ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…¨ã¦æˆåŠŸ
  - å¿…è¦ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª(/root/dev-data/*)ã¨ãƒ•ã‚¡ã‚¤ãƒ«ãŒé©åˆ‡ã«ä½œæˆ
  - curl, wget, git, apt-transport-https, ca-certificates, gnupg, lsb-releaseå…¨ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèªæ¸ˆã¿

- [x] **Dockerã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆStep 5ï¼‰** âœ…
  - Docker CE 26.1.3ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†
  - systemdã§ã®dockerè‡ªå‹•èµ·å‹•è¨­å®šå®Œäº†ï¼ˆenabledï¼‰
  - WSLç’°å¢ƒç”¨ã®é©åˆ‡ãªDockerè¨­å®šé©ç”¨
  - å†ªç­‰æ€§å®Ÿè£…ã«ã‚ˆã‚Šã€æ—¢å­˜è¨­å®šã®å®Œå…¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚‚æ­£å¸¸å‹•ä½œ
  - è¨­è¨ˆæ–¹é‡ã«å¾“ã„`validate_docker_installation`é–¢æ•°ã¯å‰Šé™¤ï¼ˆinstall_dockerå†…ã§ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å®Œçµï¼‰

**æ¤œè¨¼çµæœ:**
```bash
Docker version 26.1.3, build 26.1.3-0ubuntu1~24.04.1
â— docker.service - Docker Application Container Engine (active/running)
enabled
```

**é‡è¦ãªä¿®æ­£å±¥æ­´:**
- `auto-setup.sh`ã®ãƒ•ã‚¡ã‚¤ãƒ«å…ˆé ­ç ´æã‚’ä¿®æ­£ï¼ˆexec sudo bash "$0" "$@"ï¼‰
- è¨­è¨ˆæ–¹é‡ã€Œå˜ç´”ãªåœæ­¢æ–¹å¼ã€ã«å¾“ã„ã€validate_docker_installationé–¢æ•°ã¨ãã®å‘¼ã³å‡ºã—ã‚’å®Œå…¨å‰Šé™¤
- install_dockeré–¢æ•°å†…ã§æœ€çµ‚å‹•ä½œç¢ºèªã‚’è¿½åŠ ï¼ˆã‚¨ãƒ©ãƒ¼æ™‚ã¯è‡ªå‹•åœæ­¢ï¼‰

---

## Phase 3: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç¢ºèª ğŸ¯ âœ… **å®Œäº†**

### å®Œäº†æ¸ˆã¿
- [x] **Docker Composeæ§‹æˆä½œæˆï¼ˆStep 6ï¼‰** âœ…
  - `create_docker_compose_structure`é–¢æ•°ãŒæ­£å¸¸å‹•ä½œ
  - docker/immich/, docker/jellyfin/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ä½œæˆç¢ºèªæ¸ˆã¿
  - docker/immich/docker-compose.yml ã¨ .env ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
  - docker/jellyfin/docker-compose.yml ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ

**æ¤œè¨¼çµæœ:**
```bash
/mnt/d/ManageMediaServer/docker/immich/:
-rwxrwxrwx 1 ubuntu ubuntu 1024 May 26 05:39 .env
-rwxrwxrwx 1 ubuntu ubuntu 2817 May 26 05:39 docker-compose.yml

/mnt/d/ManageMediaServer/docker/jellyfin/:
-rwxrwxrwx 1 ubuntu ubuntu  892 May 25 20:25 docker-compose.yml
```

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
- [ ] **Immich + Jellyfin ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆStep 7ï¼‰**
  - setup_immich ã¨ setup_jellyfin é–¢æ•°ã®å‹•ä½œç¢ºèª
  - å„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Ÿè¡Œ

**å®Ÿè¡Œå‰æº–å‚™:**
```bash
# auto-setup.shã®Step 7ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’è§£é™¤
# Line 125-126: setup_immich, setup_jellyfin ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å¤–ã™
```

**æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰:**
```bash
cd /mnt/d/ManageMediaServer && sudo ./scripts/setup/auto-setup.sh --force
```

**æ¤œè¨¼:** WebUIã‚¢ã‚¯ã‚»ã‚¹ç¢ºèªï¼ˆImmich: http://localhost:2283, Jellyfin: http://localhost:8096ï¼‰

---

## Phase 4: å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ç¢ºèª ğŸŒ

### å¿…é ˆ
- [ ] **rcloneãƒ»systemdã‚µãƒ¼ãƒ“ã‚¹ï¼ˆStep 8-9ï¼‰**
  - rcloneã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
  - æœ¬ç•ªç’°å¢ƒã§ã®systemdã‚µãƒ¼ãƒ“ã‚¹è¨­å®šç¢ºèªï¼ˆdevã§ã¯å¯¾è±¡å¤–ï¼‰

---

## Phase 5: å®Œå…¨å®Ÿè¡Œç¢ºèª âœ…

### å¿…é ˆ
- [ ] **ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰æ¤œè¨¼**
  - å…¨ã‚¹ãƒ†ãƒƒãƒ—ã‚’æœ‰åŠ¹ã«ã—ã¦å®Œå…¨å®Ÿè¡Œ
  - å…¨ã‚µãƒ¼ãƒ“ã‚¹ã®åŒæ™‚èµ·å‹•ãƒ»å‹•ä½œç¢ºèª

---

## ğŸ“Œ **ç¾åœ¨ã®çŠ¶æ³ï¼ˆ2025/05/26æ™‚ç‚¹ï¼‰**

### å®Œäº†æ¸ˆã¿ã®ä½œæ¥­
1. **Phase 1-2å®Œäº†**: åŸºæœ¬æ©Ÿèƒ½ãƒ»ã‚·ã‚¹ãƒ†ãƒ åŸºç›¤ã®æ¤œè¨¼ãŒå®Œäº†
2. **Dockerç’°å¢ƒæ§‹ç¯‰æ¸ˆã¿**: Docker CE 26.1.3ãŒæ­£å¸¸å‹•ä½œä¸­
3. **è¨­è¨ˆæ–¹é‡ä¿®æ­£**: validate_docker_installationé–¢æ•°å‰Šé™¤ã«ã‚ˆã‚Šçµ±ä¸€æ„Ÿã‚’å‘ä¸Š

### æ¬¡ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã®ä½œæ¥­æ‰‹é †
1. **Step 6æœ‰åŠ¹åŒ–**: `auto-setup.sh`ã®121è¡Œç›®ä»˜è¿‘ã®`create_docker_compose_structure`ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’è§£é™¤
2. **å®Ÿè¡Œãƒ»æ¤œè¨¼**: `sudo ./scripts/setup/auto-setup.sh --force`ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
3. **çµæœç¢ºèª**: docker/immich/, docker/jellyfin/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒä½œæˆã•ã‚Œã‚‹ã‹ç¢ºèª

### é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«çŠ¶æ³
- `auto-setup.sh`: Step 1-5ã¯å‹•ä½œç¢ºèªæ¸ˆã¿ã€Step 6ä»¥é™ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆçŠ¶æ…‹
- `docker.sh`: install_dockeré–¢æ•°ã¯å†ªç­‰æ€§ä»˜ãã§å®Œæˆã€validateé–¢æ•°ã¯å‰Šé™¤æ¸ˆã¿
- Dockerç’°å¢ƒ: WSLç”¨è¨­å®šé©ç”¨æ¸ˆã¿ã€systemdè‡ªå‹•èµ·å‹•è¨­å®šæ¸ˆã¿

### æ¤œè¨¼ç’°å¢ƒæƒ…å ±
- **ç’°å¢ƒ**: WSLé–‹ç™ºç’°å¢ƒï¼ˆdevï¼‰
- **Docker**: 26.1.3 (systemdç®¡ç†ã€è‡ªå‹•èµ·å‹•enabled)
- **ãƒ‡ãƒ¼ã‚¿ãƒ«ãƒ¼ãƒˆ**: /root/dev-data/
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ**: /mnt/d/ManageMediaServer/
